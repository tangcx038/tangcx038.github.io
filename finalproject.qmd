---
title: "FINAL PROJECT"
runtime: shiny
output: html_document
---


```{r setup, include=FALSE}
library(shiny)
library(flexdashboard)
library(tidyverse)
library(highcharter)
library(gt)
library(htmltools)
library(viridis)
library(maps)
library(sf)
library(ggplot2)
library(dplyr)
library(plotly)
library(quarto)
```

```{r, results='asis', echo=FALSE}
cat("
<section class=\"image-container\">
  <img src=\"delicious-vietnamese-food-including-pho-ga-noodles-spring-rolls-white-table.jpg\" style=\"width:100%;height:300px;object-fit:cover;\"/>
  <h5 class=\"center-text-bg-img\">Unveiling the true severity of food waste</h5>
  <p class=\"bottom-right-text-bg-img\">Image by [Freepik](https://www.freepik.com/free-photo/close-up-hand-holding-wooden-board_14351726.htm#query=food%20waste&position=26&from_view=search&track=ais)</p>
</section>

<section id=\"introduction\" class=\"container\" width=\"100%\">
  <h4 class=\"text-center fw-bold my-4\">Introduction</h4>
  <p>Food comes from a long journey, starting with the farmer and ending up in our homes. This journey, called the supply chain, uses a lot of the Earth's resources. When we sit down to eat, we get to enjoy the amazing result. Tradition and good cooking bring us tasty, nourishing, joyful, passionate, and life-giving meals. However, the sad truth is that we throw away a ton of our foodâ€”loads of it! And when we do that, we're also tossing away all the valuable resources that were essential to make it in the first place.</p>

  <p>**WASTING FOOD IS WASTING AGRICULTURAL LAND.** The food produced but wasted globally every year requires 1.4 billion hectares of land, which is close to 30% of the world agricultural land area (UNEP, 2022).</p>

  <p>**WASTING FOOD IS CONTRIBUTING TO GLOBAL WARMING.** The carbon footprint of food wasted globally every year is 3.3 billion tonnes of carbon dioxide. If food waste was a country, it would be the third top emitter after the USA and China (FAO, 2011).</p>

  <p>**WASTING FOOD IS WASTING MONEY.** Besides its environmental cost, food wastage also represents a loss of economic value. On a global scale, the economic cost of the overall amount of food wastage is about $US 750 billion, equivalent to the GDP of Switzerland (FAO, 2011).</p>

  <h4 id=\"Wondering how much food we waste\" class=\"text-center fw-bold my-4\">How much **food is wasted?**</h4>
  <p>According to the **United Nations' Food and Agricultural Organisation of United Nation (FAO)**, an estimation of all the food produced every year for human consumption in the world, one-third does not reach our stomachs.</p>
</section>
")
```


```{r}
## Libraries 
library(tidyverse)
library(maps)
library(sf)
library(shiny)
library(ggplot2)
library(dplyr)
library(plotly)


createInteractiveMap <- function(data_file, map_resolution = "world") {


  # Import the data with coordinates
  world_map <- map_data(map_resolution)
  accesstonet <- read.csv(data_file)
  map_data <- accesstonet %>% rename(region = country)

  map <- left_join(world_map, map_data, by = "Country")

  # Create the ggplot object
  gg <- ggplot(map, aes(long, lat, group = group, text = paste("Country: ", country, "<br>Annual Kg per Capita: ", FoodWaste2021kgcapitayear))) +
    geom_polygon(aes(fill = FoodWaste2021kgcapitayear), color = "white", size = 0.03) +
    scale_fill_gradient(low = "lightgreen", high = "darkgreen") +
    theme_minimal()

  # Convert ggplot to plotly
  map_plotly <- ggplotly(gg, tooltip = "text")

  # Display the interactive map
  return(map_plotly)
}

## Libraries 
library(tidyverse)
library(maps)
library(sf)
library(plotly)

createInteractiveMap <- function(data_file, map_resolution = "world") {
  # Import the data with coordinates
  world_map <- map_data(map_resolution)
  accesstonet <- read.csv(data_file)
  map_data <- accesstonet %>% rename(region = country)

  map <- left_join(world_map, map_data, by = "region")

  # Create the ggplot object
  gg <- ggplot(map, aes(long, lat, group = group, text = paste("Country: ", region, "<br>Annual Kg per Capita: ", FoodWaste2021kgcapitayear))) +
    geom_polygon(aes(fill = FoodWaste2021kgcapitayear), color = "white", size = 0.03) +
    scale_fill_gradient(low = "lightgreen", high = "darkgreen") +
    theme_minimal()

  # Convert ggplot to plotly with specified width and height
  map_plotly <- ggplotly(gg, tooltip = "text", width = 1000, height = 600)

  # Set scrollZoom to FALSE
  map_plotly$x$layout$updatemenus <- list(list(type = "zoom",
showactive = FALSE,
buttons = list(list(args = list("zoomType", "zoomin"),
label = "Zoom In",
method = "relayout"),
list(args = list("zoomType", "zoomout"),
label = "Zoom Out",
method = "relayout")),
direction = "left",
pad = list(r = 10, t = 87),
showactive = FALSE,
type = "buttons",
x = 0.1,
y = 1))

  # Display the interactive map
  return(map_plotly)
}


```


```{r}
# Usage
interactiveMap <- createInteractiveMap("food-waste-by-country-2023.csv")
interactiveMap
```


